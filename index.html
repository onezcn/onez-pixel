<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OnezGame äººç‰©æ§åˆ¶ç¤ºä¾‹</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: system-ui, -apple-system, sans-serif;
      overflow: hidden;
    }
    
    #game-container {
      width: 100vw;
      height: 100vh;
    }
    
    .control-panel {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 20px;
      border-radius: 8px;
      z-index: 1000;
      max-width: 400px;
      max-height: 80vh;
      overflow-y: auto;
    }
    
    .control-panel h2 {
      margin-bottom: 15px;
      font-size: 18px;
    }
    
    .control-panel button {
      width: 100%;
      padding: 10px;
      margin: 5px 0;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    
    .control-panel button:hover {
      background: #45a049;
    }
    
    .control-panel button.danger {
      background: #f44336;
    }
    
    .control-panel button.danger:hover {
      background: #da190b;
    }
    
    .control-panel .section {
      margin: 15px 0;
      padding-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .control-panel .section-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: #4CAF50;
    }
    
    .status {
      margin-top: 15px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <!-- æ¸¸æˆå®¹å™¨ -->
  <div id="game-container"></div>
  
  <!-- æ§åˆ¶é¢æ¿ -->
  <div class="control-panel">
    <h2>OnezGame äººç‰©æ§åˆ¶ç¤ºä¾‹</h2>
    
    <div class="section">
      <div class="section-title">åŸºç¡€æ“ä½œ</div>
      <button onclick="runExample('example1')">1. æ·»åŠ  NPC</button>
      <button onclick="runExample('example2')">2. ç§»åŠ¨ NPC</button>
      <button onclick="runExample('example3')">3. è®¾ç½®æ–¹å‘</button>
      <button onclick="runExample('example4')">4. è®¾ç½®è¡Œä¸º</button>
      <button onclick="runExample('example5')" class="danger">5. ç§»é™¤ NPC</button>
    </div>
    
    <div class="section">
      <div class="section-title">AI è¡Œä¸º</div>
      <button onclick="runExample('example6')">6. éšæœºæ¸¸èµ°</button>
      <button onclick="runExample('example7')">7. è·Ÿéšç©å®¶</button>
      <button onclick="runExample('example8')">8. å·¡é€»</button>
      <button onclick="runExample('example9')">9. å¤šä¸ª NPC</button>
      <button onclick="runExample('example10')">10. å“åº”å¼ NPC</button>
    </div>
    
    <div class="section">
      <div class="section-title">é«˜çº§åŠŸèƒ½</div>
      <button onclick="runExample('example11')">11. NPC é˜Ÿåˆ—</button>
      <button onclick="runExample('example12')">12. å®šæ—¶ä»»åŠ¡</button>
      <button onclick="runExample('example13')">13. é”®ç›˜æ§åˆ¶</button>
      <button onclick="runExample('example15')">15. çŠ¶æ€ç›‘æ§</button>
    </div>
    
    <div class="section">
      <div class="section-title">è®²è¯æ°”æ³¡å’Œåç§°</div>
      <button onclick="runExample('example16')">16. æ·»åŠ å¸¦åç§° NPCï¼ˆä¸Šï¼‰</button>
      <button onclick="runExample('example17')">17. æ·»åŠ å¸¦åç§° NPCï¼ˆä¸‹ï¼‰</button>
      <button onclick="runExample('example18')">18. æ˜¾ç¤ºè®²è¯æ°”æ³¡</button>
      <button onclick="runExample('example19')">19. æ°¸ä¹…è®²è¯æ°”æ³¡</button>
      <button onclick="runExample('example20')">20. éšè—è®²è¯æ°”æ³¡</button>
      <button onclick="runExample('example21')">21. è®¾ç½®åç§°</button>
      <button onclick="runExample('example22')">22. æ›´æ”¹åç§°ä½ç½®</button>
      <button onclick="runExample('example23')">23. éšè—åç§°</button>
      <button onclick="runExample('example24')">24. å¯¹è¯åºåˆ—</button>
      <button onclick="runExample('example25')">25. å¤šä¸ª NPC è®²è¯</button>
    </div>

    <div class="section">
      <div class="section-title">æ€è€ƒçŠ¶æ€ï¼ˆğŸ’­ï¼‰</div>
      <button onclick="runExample('example26')">26. æ˜¾ç¤ºæ€è€ƒçŠ¶æ€</button>
      <button onclick="runExample('example27')">27. æ°¸ä¹…æ€è€ƒçŠ¶æ€</button>
      <button onclick="runExample('example28')">28. éšè—æ€è€ƒçŠ¶æ€</button>
      <button onclick="runExample('example29')">29. æ€è€ƒåè®²è¯</button>
      <button onclick="runExample('example30')">30. å¤šä¸ª NPC æ€è€ƒ</button>
    </div>

    <div class="section">
      <div class="section-title">å¯»è·¯åŠŸèƒ½</div>
      <button onclick="runExample('example31')">31. åŸºæœ¬å¯»è·¯</button>
      <button onclick="runExample('example32')">32. å¯»è·¯åˆ°ç©å®¶</button>
      <button onclick="runExample('example33')">33. å¤šä¸ª NPC å¯»è·¯</button>
      <button onclick="runExample('example34')">34. å¯»è·¯ååŠ¨ä½œ</button>
      <button onclick="runExample('example35')">35. ç»•è¿‡éšœç¢ç‰©</button>
    </div>
    
    <div class="status" id="status">
      ç­‰å¾…æ¸¸æˆåˆå§‹åŒ–...
    </div>
  </div>

  <!-- åŠ è½½ OnezGame CDN æ–‡ä»¶ -->
  <script src="./dist/cdn/onezgame.min.js"></script>
  
  <!-- åŠ è½½æ§åˆ¶ç¤ºä¾‹ï¼ˆåŒ…å«è®²è¯æ°”æ³¡åŠŸèƒ½ï¼‰ -->
  <script src="./examples/character-control-examples.js"></script>
  
  <script>
    let gameInstance = null;
    
    // åˆå§‹åŒ–æ¸¸æˆ
    function initGame() {
      if (gameInstance) {
        gameInstance.destroy();
      }
      
      gameInstance = window.onezgame({
        container: 'game-container',
        assetsBaseUrl: '/assets',
        showUI: true,
        title: 'äººç‰©æ§åˆ¶ç¤ºä¾‹',
        hint: 'ä½¿ç”¨æ§åˆ¶é¢æ¿æµ‹è¯•å„ç§ NPC è¡Œä¸º',
        backgroundColor: 0x7ab5ff,
      });
      
      updateStatus('æ¸¸æˆå·²åˆå§‹åŒ–ï¼Œå¯ä»¥ä½¿ç”¨æ§åˆ¶é¢æ¿');
      
      // ç­‰å¾…æ§åˆ¶å™¨å°±ç»ªï¼ˆå¤šæ¬¡æ£€æŸ¥ï¼Œå› ä¸ºæ¨¡å—åŠ è½½å¯èƒ½éœ€è¦æ—¶é—´ï¼‰
      let checkCount = 0;
      const maxChecks = 10;
      const checkController = () => {
        checkCount++;
        if (window.onezGameController) {
          updateStatus('æ§åˆ¶å™¨å·²å°±ç»ªï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•');
          console.log('æ§åˆ¶å™¨å¯ç”¨:', window.onezGameController);
        } else if (checkCount < maxChecks) {
          setTimeout(checkController, 200);
        } else {
          updateStatus('è­¦å‘Šï¼šæ§åˆ¶å™¨æœªæ‰¾åˆ°ã€‚è¯·æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯ã€‚');
          console.error('OnezGameController æœªæ‰¾åˆ°ã€‚å¯ç”¨çš„å…¨å±€å¯¹è±¡:', Object.keys(window).filter(k => k.includes('onez') || k.includes('Onez')));
        }
      };
      checkController();
    }
    
    // è¿è¡Œç¤ºä¾‹
    function runExample(exampleName) {
      if (!window.OnezGameExamples) {
        updateStatus('é”™è¯¯ï¼šç¤ºä¾‹ä»£ç æœªåŠ è½½');
        return;
      }
      
      const example = window.OnezGameExamples[exampleName];
      if (!example) {
        updateStatus(`é”™è¯¯ï¼šç¤ºä¾‹ ${exampleName} ä¸å­˜åœ¨`);
        return;
      }
      
      try {
        example();
        updateStatus(`å·²æ‰§è¡Œ: ${exampleName}`);
      } catch (error) {
        updateStatus(`é”™è¯¯: ${error.message}`);
        console.error(error);
      }
    }
    
    // æ›´æ–°çŠ¶æ€
    function updateStatus(message) {
      const statusEl = document.getElementById('status');
      if (statusEl) {
        statusEl.textContent = message;
      }
      console.log(message);
    }
    
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', () => {
      initGame();
    });
    
    // ç›‘å¬ NPC æ›´æ–°ï¼ˆç”¨äºçŠ¶æ€æ˜¾ç¤ºï¼‰
    if (window.onezGameController) {
      window.onezGameController.onNPCUpdate((npcs) => {
        updateStatus(`å½“å‰æœ‰ ${npcs.length} ä¸ª NPC`);
      });
    }
  </script>
</body>
</html>

